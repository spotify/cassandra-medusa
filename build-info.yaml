version: 2

pipelines:
  - pipeline: 'shared'
    ref: '.*'
    stages:
      - stage: 'tox'
        tasks:
          - task: 'tox'
            steps:
              - action: 'gcr.io/action-containers/tox:3.13.2-1@sha256:7573fa1887325fbfe8e61dd4e264438b9e38f6e1d646569be624c742b2373a39'
                args: ['-c', 'tox.ini']
      - stage: 'integration tests'
        tasks:
          - task: 'aloe'
            steps:
              - action: 'gcr.io/action-containers/medusa-it:1.0.0-2'
                entrypoint: "/bin/bash"
                args: ["run_integration_tests.sh"]
